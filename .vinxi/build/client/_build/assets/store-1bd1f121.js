import{$ as y,J as W,H as F,C as a,e as q}from"./web-0901fd59.js";const R=Symbol("store-raw"),S=Symbol("store-node"),b=Symbol("store-has"),z=Symbol("store-self");function C(n){let e=n[y];if(!e&&(Object.defineProperty(n,y,{value:e=new Proxy(n,X)}),!Array.isArray(n))){const f=Object.keys(n),l=Object.getOwnPropertyDescriptors(n);for(let o=0,i=f.length;o<i;o++){const c=f[o];l[c].get&&Object.defineProperty(n,c,{enumerable:l[c].enumerable,get:l[c].get.bind(e)})}}return e}function O(n){let e;return n!=null&&typeof n=="object"&&(n[y]||!(e=Object.getPrototypeOf(n))||e===Object.prototype||Array.isArray(n))}function P(n,e=new Set){let f,l,o,i;if(f=n!=null&&n[R])return f;if(!O(n)||e.has(n))return n;if(Array.isArray(n)){Object.isFrozen(n)?n=n.slice(0):e.add(n);for(let c=0,t=n.length;c<t;c++)o=n[c],(l=P(o,e))!==o&&(n[c]=l)}else{Object.isFrozen(n)?n=Object.assign({},n):e.add(n);const c=Object.keys(n),t=Object.getOwnPropertyDescriptors(n);for(let s=0,r=c.length;s<r;s++)i=c[s],!t[i].get&&(o=n[i],(l=P(o,e))!==o&&(n[i]=l))}return n}function N(n,e){let f=n[e];return f||Object.defineProperty(n,e,{value:f=Object.create(null)}),f}function D(n,e,f){if(n[e])return n[e];const[l,o]=q(f,{equals:!1,internal:!0});return l.$=o,n[e]=l}function J(n,e){const f=Reflect.getOwnPropertyDescriptor(n,e);return!f||f.get||!f.configurable||e===y||e===S||(delete f.value,delete f.writable,f.get=()=>n[y][e]),f}function H(n){F()&&D(N(n,S),z)()}function V(n){return H(n),Reflect.ownKeys(n)}const X={get(n,e,f){if(e===R)return n;if(e===y)return f;if(e===W)return H(n),f;const l=N(n,S),o=l[e];let i=o?o():n[e];if(e===S||e===b||e==="__proto__")return i;if(!o){const c=Object.getOwnPropertyDescriptor(n,e);F()&&(typeof i!="function"||n.hasOwnProperty(e))&&!(c&&c.get)&&(i=D(l,e,i)())}return O(i)?C(i):i},has(n,e){return e===R||e===y||e===W||e===S||e===b||e==="__proto__"?!0:(F()&&D(N(n,b),e)(),e in n)},set(){return!0},deleteProperty(){return!0},ownKeys:V,getOwnPropertyDescriptor:J};function h(n,e,f,l=!1){if(!l&&n[e]===f)return;const o=n[e],i=n.length;f===void 0?(delete n[e],n[b]&&n[b][e]&&o!==void 0&&n[b][e].$()):(n[e]=f,n[b]&&n[b][e]&&o===void 0&&n[b][e].$());let c=N(n,S),t;if((t=D(c,e,o))&&t.$(()=>f),Array.isArray(n)&&n.length!==i){for(let s=n.length;s<i;s++)(t=c[s])&&t.$();(t=D(c,"length",i))&&t.$(n.length)}(t=c[z])&&t.$()}function I(n,e){const f=Object.keys(e);for(let l=0;l<f.length;l+=1){const o=f[l];h(n,o,e[o])}}function Y(n,e){if(typeof e=="function"&&(e=e(n)),e=P(e),Array.isArray(e)){if(n===e)return;let f=0,l=e.length;for(;f<l;f++){const o=e[f];n[f]!==o&&h(n,f,o)}h(n,"length",l)}else I(n,e)}function _(n,e,f=[]){let l,o=n;if(e.length>1){l=e.shift();const c=typeof l,t=Array.isArray(n);if(Array.isArray(l)){for(let s=0;s<l.length;s++)_(n,[l[s]].concat(e),f);return}else if(t&&c==="function"){for(let s=0;s<n.length;s++)l(n[s],s)&&_(n,[s].concat(e),f);return}else if(t&&c==="object"){const{from:s=0,to:r=n.length-1,by:u=1}=l;for(let d=s;d<=r;d+=u)_(n,[d].concat(e),f);return}else if(e.length>1){_(n[l],e,[l].concat(f));return}o=n[l],f=[l].concat(f)}let i=e[0];typeof i=="function"&&(i=i(o,f),i===o)||l===void 0&&i==null||(i=P(i),l===void 0||O(o)&&O(i)&&!Array.isArray(i)?I(o,i):h(n,l,i))}function B(...[n,e]){const f=P(n||{}),l=Array.isArray(f),o=C(f);function i(...c){a(()=>{l&&c.length===1?Y(f,c[0]):_(f,c)})}return[o,i]}const M=Symbol("store-root");function j(n,e,f,l,o){const i=e[f];if(n===i)return;if(f!==M&&(!O(n)||!O(i)||o&&n[o]!==i[o])){h(e,f,n);return}if(Array.isArray(n)){if(n.length&&i.length&&(!l||o&&n[0]&&n[0][o]!=null)){let s,r,u,d,A,w,E,$;for(u=0,d=Math.min(i.length,n.length);u<d&&(i[u]===n[u]||o&&i[u]&&n[u]&&i[u][o]===n[u][o]);u++)j(n[u],i,u,l,o);const g=new Array(n.length),K=new Map;for(d=i.length-1,A=n.length-1;d>=u&&A>=u&&(i[d]===n[A]||o&&i[u]&&n[u]&&i[d][o]===n[A][o]);d--,A--)g[A]=i[d];if(u>A||u>d){for(r=u;r<=A;r++)h(i,r,n[r]);for(;r<n.length;r++)h(i,r,g[r]),j(n[r],i,r,l,o);i.length>n.length&&h(i,"length",n.length);return}for(E=new Array(A+1),r=A;r>=u;r--)w=n[r],$=o&&w?w[o]:w,s=K.get($),E[r]=s===void 0?-1:s,K.set($,r);for(s=u;s<=d;s++)w=i[s],$=o&&w?w[o]:w,r=K.get($),r!==void 0&&r!==-1&&(g[r]=i[s],r=E[r],K.set($,r));for(r=u;r<n.length;r++)r in g?(h(i,r,g[r]),j(n[r],i,r,l,o)):h(i,r,n[r])}else for(let s=0,r=n.length;s<r;s++)j(n[s],i,s,l,o);i.length>n.length&&h(i,"length",n.length);return}const c=Object.keys(n);for(let s=0,r=c.length;s<r;s++)j(n[c[s]],i,c[s],l,o);const t=Object.keys(i);for(let s=0,r=t.length;s<r;s++)n[t[s]]===void 0&&h(i,t[s],void 0)}function G(n,e={}){const{merge:f,key:l="id"}=e,o=P(n);return i=>{if(!O(i)||!O(o))return o;const c=j(o,{[M]:i},M,f,l);return c===void 0?i:c}}const T=new WeakMap,L={get(n,e){if(e===R)return n;const f=n[e];let l;return O(f)?T.get(f)||(T.set(f,l=new Proxy(f,L)),l):f},set(n,e,f){return h(n,e,P(f)),!0},deleteProperty(n,e){return h(n,e,void 0,!0),!0}};function Q(n){return e=>{if(O(e)){let f;(f=T.get(e))||T.set(e,f=new Proxy(e,L)),n(f)}return e}}export{B as c,Q as p,G as r};
