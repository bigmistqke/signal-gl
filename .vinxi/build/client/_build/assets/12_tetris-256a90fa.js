import{C as U,S as z,a as H}from"./index-16d02734.js";import{k as V,n as Y,w as q}from"./names-f7f818c5.js";import{b as n,e as b,a as G,o as K,I as O,S as _,m as Q,F as x,C as E}from"./web-0901fd59.js";import{c as I,p as W}from"./store-1bd1f121.js";import"./index-cb1a4aba.js";import"./mat4-bfe45697.js";V([Y]);const le=2,fe=8,ue=125,d={I:[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],O:[[1,1],[1,1]],T:[[0,1,0],[1,1,1],[0,0,0]],S:[[0,1,1],[1,1,0],[0,0,0]],Z:[[1,1,0],[0,1,1],[0,0,0]],J:[[0,1,0],[0,1,0],[1,1,0]],L:[[0,1,0],[0,1,0],[0,1,1]]},L={I:"cyan",O:"yellow",T:"purple",S:"green",J:"blue",Z:"red",L:"orange"},P=t=>{const{r:c,g:l,b:i}=q(t).toRgb();return[c/255,l/255,i/255]},X=t=>t[0].map((c,l)=>t.map(i=>i[l]).reverse()),R=t=>n(H,{get position(){return[t.position[0]-.25,t.position[1]-.25,-.25]},get scale(){return t.scale?[t.scale,t.scale,t.scale]:void 0},get color(){return t.color}}),M=t=>{const c=()=>{const[l,i,f]=P(L[t.type]);return t.preview?[l*.5,i*.5,f*.5]:[l,i,f]};return n(x,{get each(){return t.state},children:(l,i)=>n(x,{each:l,children:(f,T)=>n(_,{when:f,get children(){return n(R,{get position(){return[t.position[0]+i(),t.position[1]+T()]},get color(){return c()},scale:.7,opacity:1})}})})})},v=()=>{const t=Object.keys(d)[Math.floor(Math.random()*(Object.keys(d).length-1))];return{state:d[t],type:t,position:[5-Math.floor(d[t].length/2),d[t][0].length*-1+20]}},$=()=>[new Array(21).fill("").map(t=>"white"),...new Array(10).fill("").map(t=>["white",...new Array(20).fill("").map(c=>{})]),new Array(21).fill("").map(t=>"white")],ee=()=>{const[t,c]=I($()),[l,i]=b(0),[f,T]=b(1),[s,h]=I(v()),y=(e=s)=>{let o=0;for(;!m({...e,offset:[0,o-1]});)o--;return o},F=()=>{const e=y();h("position",1,o=>o+e),S(),C.evaluate()},N=()=>{const e=X(s.state);m({state:e})||h("state",e)},g=e=>{m({offset:e})||(h("position",0,r=>r+e[0]),h("position",1,r=>r+e[1]))};b(!0);const m=e=>{let o=!1;const r=e?.state||s.state,a=e?.position?e.position:s.position,u=e?.offset?[a[0]+e.offset[0],a[1]+e.offset[1]]:a;for(let p=0;p<r.length;p++){const A=r[p];for(let w=0;w<A.length;w++)if(A[w]&&t[p+u[0]]?.[w+u[1]]){o=!0;break}}return o},D=(e=1e3)=>new Promise(o=>setTimeout(o,e)),Z=()=>{const e=v();m(e)||h(v())},S=()=>{for(let e=0;e<s.state.length;e++){const o=s.state[e];for(let r=0;r<o.length;r++)o[r]&&c(e+s.position[0],r+s.position[1],L[s.type])}},j=e=>{const o=()=>{switch(e){case 1:return 100*f();case 2:return 300*f();case 3:return 500*f();case 4:return 800*f();default:return 0}};i(r=>r+o())},B=async()=>{m({offset:[0,-1]})&&(S(),Z());const e=[];t[0].slice(1).forEach((o,r)=>{let a=r+1,u=!0;for(let p=0;p<t.length;p++)if(!(t[p][a]&&o)){u=!1;break}u&&e.push(a)}),e.forEach(o=>{E(()=>{for(let r=t.length-2;r>0;r--)c(r,o,void 0)})}),e.reverse(),e.length>0&&j(e.length),await D(125),E(()=>{for(let o=1;o<t.length-1;o++)c(o,W(r=>{e.forEach(a=>{r.splice(a,1),r.push(void 0)})}))})},C=(()=>{let e="Translate",o=performance.now();const r=()=>{o=performance.now(),e="Evaluate",m({offset:[0,-1]})||h("position",1,u=>u-1)},a=()=>{o=performance.now(),e="Translate",B()};return{update:()=>{performance.now()-o>125&&(e==="Evaluate"?a():r())},translate:r,evaluate:a}})(),J=G(K(y,e=>({...s,position:[s.position[0],s.position[1]+e]})));let k=!1;return window.addEventListener("keydown",e=>{switch(k||(k=!0,setInterval(()=>C.update(),1e3/60)),e.code){case"ArrowUp":N();break;case"ArrowLeft":g([-1,0]);break;case"ArrowRight":g([1,0]);break;case"ArrowDown":g([0,-1]);break;case"Space":F();break}}),[n(O,{each:t,children:(e,o)=>n(O,{get each(){return e()},children:(r,a)=>n(_,{get when(){return r()},children:u=>n(R,{scale:.7,get color(){return P(u())},position:[o,a]})})})}),n(M,s),n(M,Q(J,{preview:!0}))]};function pe(){return n(z,{get children(){return[n(U,{position:[5,10,90],rotation:[0,0,0],active:!0,fov:15}),n(ee,{})]}})}export{fe as AMOUNT,ue as DELAY,le as SIZE,pe as default};
